# Threads API

Бэкенд-сервис для работы с постами, комментариями и лайками.

## Функционал

- Создание, чтение, обновление и удаление постов
- Автоматическое создание тематических тегов на основе содержания поста
- Добавление и удаление лайков
- Создание и просмотр комментариев (в том числе вложенных)
- Система логирования и подробная обработка ошибок

## Установка и запуск

1. Клонировать репозиторий
2. Установить зависимости:
```
pip install -r requirements.txt
```
3. Установить модели для Natasha:
```
python -m natasha download
```
4. Запустить сервер:
```
python main.py
```

Или используя uvicorn напрямую:
```
uvicorn main:app --reload
```

## API Documentation

После запуска сервера документация API доступна по адресу:
```
http://localhost:8000/docs
```

## Схема базы данных

Сервис работает с PostgreSQL-базой данных, содержащей следующие таблицы:
- post_table - посты и комментарии
- like_table - лайки
- tag_table - теги
- tags_for_post_table - связи тегов с постами
- и другие

## Система логирования и обработки ошибок

В проекте реализована расширенная система логирования и обработки ошибок:

### Логирование:
- Все запросы и ответы логируются в `logs/app.log`
- Ошибки отдельно логируются в `logs/errors.log`
- Для каждой ошибки создается отдельный JSON-файл с подробной информацией в директории `logs/`

### Обработка ошибок:
- Пользователь всегда получает информативное сообщение об ошибке
- Каждая ошибка имеет уникальный идентификатор для упрощения отладки
- Подробная классификация ошибок (ошибки базы данных, валидации и т.д.)

### Пример ответа с ошибкой:
```json
{
  "detail": "Отсутствует обязательное поле",
  "error_id": "20250412152230",
  "error_type": "database_constraint",
  "error_message": "null value in column 'post_id' violates not-null constraint"
}
``` 