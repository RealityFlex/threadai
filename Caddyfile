sber.levandrovskiy.ru {
    # Автоматически получить и настроить SSL-сертификат Let's Encrypt
    tls internal

    # Логирование
    log {
        output file /data/access.log {
            roll_size 10MB
            roll_keep 10
        }
    }

    # Проксирование запросов к FastAPI приложению
    reverse_proxy web:8000 {
        # Настройки прокси
        header_up Host {host}
        header_up X-Real-IP {remote}
        header_up X-Forwarded-For {remote}
        header_up X-Forwarded-Proto {scheme}
    }

    # Включить сжатие для уменьшения размера передаваемых данных
    encode gzip
    
    # Базовые настройки безопасности
    header {
        # Включаем HSTS
        Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
        # Защита от кликджекинга
        X-Frame-Options "SAMEORIGIN"
        # Защита от XSS
        X-XSS-Protection "1; mode=block"
        # Защита от снифинга MIME-типов
        X-Content-Type-Options "nosniff"
        # Запрет на информацию о сервере
        -Server
    }
} 